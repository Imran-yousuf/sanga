$.rAutocompleteCacheName="rAutocompleteCache",$.createAutocompleters=function(a,e){function t(a){var e=a.attr("id").replace("ac-","");a.data("selectedId")&&($("#"+e).val(a.data("selectedId")),a.removeClass("callout alert"))}e=$.extend({cacheName:$.rAutocompleteCacheName,baseUrl:""},e);var l=function(){var a=$(this),l=a.val();if(l&&-1==l.indexOf(" ")){var c=a.data("ac")+"/"+l,i=$.localStorage(e.cacheName+"."+c);i?(a.val(i[0].label),a.data("selectedId",i[0].value),t(a)):(a.addClass("loading"),$(':input[data-type="submit"]').prop("disabled",!0),$.ajax({dataType:"json",url:e.baseUrl+a.data("ac")+"?term="+l,success:function(l){a.removeClass("loading"),l[0]?($.localStorage(e.cacheName+"."+c,l),a.val(l[0].label),a.data("selectedId",l[0].value),t(a),$(':input[data-type="submit"]').prop("disabled",!1)):(a.effect("shake"),a.val("???"),noty({layout:"topRight",type:"error",timeout:5e3,closeWith:["click"],text:"Data error"}))}}))}else t(a)};$.createAutocompleters.blurHandler=l;var c=$("#"+a+" input[data-ac]");c.each(function(){var a=$(this).attr("id"),t=a.replace(/-/,"_");$(this).attr("id","ac-"+a),$(this).attr("name","ac-"+t),$(this).attr("autocomplete","off");var c='<input name="'+t+'" id="'+a+'" value="'+$(this).val()+'" type="hidden">';$(this).after(c),$(this).val($(this).data("val")),$(this).autocomplete($.autocompletefactory({url:e.baseUrl+$(this).data("ac"),cacheName:e.cacheName})),$(this).blur(l)}),$("body").append('<div id="dialog"></div>'),$("#dialog").dialog({autoOpen:!1,width:500}),$("#dialog").on("click",function(a){var e=$(a.target).data("target");e.replace("ac-","");$("#"+e).val($(a.target).text()),$("#"+e).data("selectedId",$(a.target).data("id")),$("#dialog").dialog("close")})},$.autocompletefactory=function(a){var e=$.extend({resultCount:5,minLength:2},a);if(e.cacheName&&($.rAutocompleteCacheName=e.cacheName),!e.url)throw new Error("autocompelete factory called without url parameter");null===$.localStorage(e.cacheName)&&$.localStorage(e.cacheName,{});var t=new Date;return $.localStorage(e.cacheName+".time")&&$.localStorage(e.cacheName+".time")<t-432e5&&$.localStorage.remove(e.cacheName),$.localStorage(e.cacheName,{time:t.getTime()}),{resultCount:e.resultCount,minLength:e.minLength,source:function(a,t){var l,c=e.url+"/"+a.term;if(c in $.localStorage(e.cacheName)?l=$.localStorage(e.cacheName)[c]:$.ajax({async:!1,dataType:"json",url:e.url,data:a,success:function(a,t,i){0!=a.length&&$.localStorage(e.cacheName+"."+c,a),l=a}}),0==l.length)return t({label:"Hiba: nincs talà¸£à¸�lat!",value:-1}),!1;-1==a.term.indexOf("*")&&l.push({label:a.term+" *",value:0}),t(l),$(this.element).data("selectedId",l[0].value)},open:function(a,e){-1==$(this).val().indexOf("*")&&$(".ui-autocomplete li:last div").html('<i class="fi-magnifying-glass"> '+$(this).val()+" * </i>")},focus:function(a,e){$(this).val(e.item.label),$(this).data("selectedId",e.item.value),a.preventDefault()},select:function(a,t){$(this).val(t.item.label),$(this).data("selectedId",t.item.value),0===t.item.value&&$.ajax({dataType:"json",url:e.url,data:{term:t.item.label.replace(" *",""),limit:50},input:$(this),success:function(a){$("#dialog").dialog("option","title",t.item.label);var e=this.input.attr("id");$.each(a,function(a,t){$("#dialog").append('<li data-id="'+t.value+'" data-target="'+e+'">'+t.label+"</li>")}),$("#dialog").dialog("open")}}),a.preventDefault()}}};