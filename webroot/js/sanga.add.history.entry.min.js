$(function(){$.createAutocompleters("hForm",{baseUrl:$.sanga.baseUrl}),$("#date").datepicker({beforeShow:function(t,a){window.navigator.userAgent.search(/Firefox/)&&a.dpDiv.css({top:220+t.offsetHeight+"px"})}}),$("#xcontact-id").autocomplete({minLength:2,html:!0,source:$.sanga.baseUrl+"/Contacts/search",focus:function(){return!1},select:function(t,a){return this.value=a.item.label.replace(/(<([^>]+)>)/gi,""),$("#contact-id").val(a.item.value),!1},change:function(t,a){return this.value=a.item.label.replace(/(<([^>]+)>)/gi,""),$("#contact-id").val(a.item.value),!1}}),$("#hsave").click(function(t){var a=$("#hInfo");a.append($("#ajaxloader").show()),$("#hsave").hide();var e={contact_id:$("#contact-id").val(),date:$("#date").val(),group_id:$("#group-id").val(),event_id:$("#event-id").val(),detail:$("#detail").val(),target_group_id:$("#target-group-id").val(),family:null};return $("#quantity").val()&&(e.quantity=$("#quantity").val(),e.unit_id=$("#unit-id").val()),$.ajax({url:$("#hForm").attr("action"),data:e,type:"post",dataType:"json",error:function(t,a,e){$("#ajaxloader").hide(),noty({text:a,type:"error",animation:$.sanga.animation}),$("#hsave").show()},success:function(t,a,e){$("#ajaxloader").hide(),noty({text:e.responseJSON.errors?e.responseJSON.message+" "+e.responseJSON.errors:e.responseJSON.message,type:e.responseJSON.success?"success":"error",animation:$.sanga.animation,buttons:!1,timeout:2});var n=$("<tr>"),i="";-1!=location.pathname.search(/histories/i)?i+='<td><a href="'+$.sanga.baseUrl+"/contacts/view/"+$("#contact-id").val()+'">'+$("#xcontact-id").val()+"</a></td>":i+="<td></td>",i+="<td>"+$("#date").val()+"</td>",i+="<td>"+$("#uName").text()+"</td>",i+="<td>"+$("#ac-group-id").val()+"</td>",i+="<td>"+$("#ac-event-id").val()+"</td>",i+="<td>"+$("#detail").val()+"</td>",i+='<td class="r">',$("#quantity").val()&&(i+=$("#quantity").val()+"  Ft"),i+="</td>",i+="<td></td>",n.append(i),$("#hTable > tbody").children("tr:first").after(n),$("#hForm :input").not(".dontdel").val(""),$("#hsave").show()}}),t.preventDefault(),!1})});