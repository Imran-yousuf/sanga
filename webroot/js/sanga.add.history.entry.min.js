$(function(){$("#date").datepicker({beforeShow:function(t,e){window.navigator.userAgent.search(/Firefox/)&&e.dpDiv.css({top:220+t.offsetHeight+"px"})}}),$("#xcontact-id").autocomplete({minLength:2,html:!0,source:$.sanga.baseUrl+"/Contacts/search",focus:function(){return!1},select:function(t,e){return this.value=e.item.label.replace(/(<([^>]+)>)/gi,""),$("#contact-id").val(e.item.value),!1},change:function(t,e){return this.value=e.item.label.replace(/(<([^>]+)>)/gi,""),$("#contact-id").val(e.item.value),!1}}),$("#xgroup-id").autocomplete({minLength:2,html:!0,source:$.sanga.baseUrl+"/Groups/search",focus:function(){return!1},select:function(t,e){return this.value=e.item.label.replace(/(<([^>]+)>)/gi,""),$("#group-id").val(e.item.value),!1},change:function(t,e){return this.value=e.item.label.replace(/(<([^>]+)>)/gi,""),$("#group-id").val(e.item.value),!1}}),$("#xevent-id").autocomplete({minLength:2,html:!0,source:$.sanga.baseUrl+"/Events/search",focus:function(){return!1},select:function(t,e){return this.value=e.item.label.replace(/(<([^>]+)>)/gi,""),$("#event-id").val(e.item.value),!1},change:function(t,e){return this.value=e.item.label.replace(/(<([^>]+)>)/gi,""),$("#event-id").val(e.item.value),!1}}),$("#hsave").click(function(t){var e=$("#hInfo");e.append($("#ajaxloader").show()),$("#hsave").hide();var a={contact_id:$("#contact-id").val(),date:$("#date").val(),group_id:$("#group-id").val(),event_id:$("#event-id").val(),detail:$("#detail").val(),target_group_id:$("#target-group-id").val(),family:null};return $("#quantity").val()&&(a.quantity=$("#quantity").val(),a.unit_id=$("#unit-id").val()),$.ajax({url:$("#hForm").attr("action"),data:a,type:"post",dataType:"json",error:function(t,e,a){$("#ajaxloader").hide(),noty({text:e,type:"error",animation:$.sanga.animation}),$("#hsave").show()},success:function(t,e,a){$("#ajaxloader").hide(),noty({text:a.responseJSON.errors?a.responseJSON.message+" "+a.responseJSON.errors:a.responseJSON.message,type:a.responseJSON.success?"success":"error",animation:$.sanga.animation,buttons:!1,timeout:2});var n=$("<tr>"),i="";i+=location.pathname.search(/histories/i)!=-1?'<td><a href="'+$.sanga.baseUrl+"/contacts/view/"+$("#contact-id").val()+'">'+$("#xcontact-id").val()+"</a></td>":"<td></td>",i+="<td>"+$("#date").val()+"</td>",i+="<td>"+$("#uName").text()+"</td>",i+="<td>"+$("#xgroup-id").val()+"</td>",i+="<td>"+$("#xevent-id").val()+"</td>",i+="<td>"+$("#detail").val()+"</td>",i+='<td class="r">',$("#quantity").val()&&(i+=$("#quantity").val()+"  Ft"),i+="</td>",i+="<td></td>",n.append(i),$("#hTable > tbody").children("tr:first").after(n),$("#hForm :input").not(".dontdel").val(""),$("#hsave").show()}}),t.preventDefault(),!1})});